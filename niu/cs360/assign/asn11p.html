<html>
<head>
<title>CSCI 360 Program 11</title>
</head>
<body Bgcolor=FFFFFF>

<table Cellspacing="1" width=100%>
<tr>
	<td align=left valign=top><b>CSCI 360</b></td>
	<td align=right valign=top><b>Fall 2001</b></td>
	</tr>
</table>

<H1><center>Program 11 - Macro Instructions <BR>(100 points)</center></H1>

<p>
<div align="center"><h2>(Updated 12/3/2001)</h2></div>
<hr size=4 noshade>


<h2>Overview</h2>

This assignment repeats Program 9 with a new set of data and with the use of Macros.&nbsp; As in Program 9 you are to run a test of your HT data base program using the data file provided. <br>
<br>
All CSECTs are expected to use 12 as the base register. <br>
<br>
You are to provide Macros for &quot;Standard Entry&quot; (STDENT), &quot;Standard Exit&quot; (STDEXT), and &quot;Standard Call&quot; (STDCAL).&nbsp; All macros must be located at the beginning of your programming assignment, they must include appropriate line documentation and each macro must have a &quot;doc box&quot; (see Class Notes, p. 23 ff). <br>
<br>
To test your macros, you will create a minimum CSECT named &quot;TEST&quot; that will be located following your MAIN routine and before any of your following subroutines.&nbsp; This routine will use the following: <br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; TEST&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STDENT&nbsp; (3,5),BR=0 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STDEXT&nbsp; (0,1,0,1) <br>
<h4><font size=4>STDENT Macro</font></b></h4>Prototype: <br>
<br>
&amp;CNAM&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STDENT&nbsp;&nbsp;&nbsp; &amp;PLREGS,&amp;BR=0 <br>
<br>
&amp;CNAM is the label on the CSECT statement that will be generated by this macro.&nbsp; The length of &amp;CNAM should be 4 bytes.&nbsp; &amp;BD is the base register to use for this CSECT.&nbsp; The default for this keyword parameter is 0.&nbsp; Within this macro you will reference a Standard Linkage Save Area that will be located following the LTORG that follows the Standard Exit Linkage code at the end of the STDEXT macro that defines the end of this CSECT.&nbsp; The name of this save area will be a concatenation of &amp;CNAM with SAVE.&nbsp; The name of this save area will be passed to the STDEXT macro that follows the STDENT macro through the use of a global set symbol <br>
<br>
&amp;PLREGS is a symbolic parameter containing two subparameters.&nbsp; The subparameters are the&nbsp; First and Second Registers for the LM instruction to load the addresses passed in by the parameter list.&nbsp; If this parameter is omitted, no LM instruction should be generated. <br>
<br>
<!-- To test your STDENT macro you should use the following in your MAIN program: <br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; MAIN&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STDENT&nbsp; (14,14),BR=12 <br> -->
<h4><font size=4>STDEXT Macro</font></b></h4>Prototype: <br>
<br>
&amp;LABEL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STDEXT&nbsp;&nbsp; &amp;REGS <br>
<br>
&amp;REGS contains up to three sub parameters.&nbsp; These subparameters may be 15, or 0, or 1.&nbsp; They designate which registers are to be passed back to the calling routine. When it is specified that a register is to have its value returned to the calling routine, the contents of that register should be stored into the appropriate location in the 18 full word area from which the Standard Exit Linkage will restore registers.&nbsp; The conclusion of the exit linkage will then be restoring all registers (R14 through R12) from the save area followed by BR&nbsp; R14. <br>
<br>
In the event that registers other than 15, 0, or 1 are specified, a severity 4 MNOTE should be generated stating that &quot;Standard Exit Linkage&quot; will be used.&nbsp; Then code should be generated that will restore all registers without passing back and values in 15, 0, or 1. <br>
<br>
In the event that more than 3 registers are specified, a severity 4 MNOTE should be generated stating that &quot;Standard Exit Linkage&quot; will be used.&nbsp; The standard exit code should then be generated as above. <br>
<br>
Following the BR&nbsp; R14 instruction, a LTORG should be generated.&nbsp; This should be followed by an 18 full word save area aligned on a full word boundary.&nbsp; The name of this save area, as well as the contents of the 9CL8 fields that comprise this area should be the 8-byte name created by the STDENT macro and passed to this macro through the use of a global set symbol. <br>
<br>
To test your STDEXT macro you should use the following to exit your MAIN routine: <br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;LABEL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STDEXT&nbsp;&nbsp; (2) <br>
<h4><font size=4>STDCAL Macro</font></b></h4>Prototype: <br>
<br>
&amp;LABEL&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; STDCAL&nbsp; &amp;CNAM,&amp;PAR,&amp;BTAB <br>
<br>
&amp;CNAM is the CSECT name of the called subroutine.&nbsp; &amp;PAR is a list of parameters to pass to the subroutine either in the form of the label of a parameter list, or as a literal of an address constant.&nbsp; &amp;BTAB is a parameter that may contain (up to a maximum of 4) labels to be used as the targets of branch table entries on return from the called subroutine, the first label for a RC (in R15) of 0, the second for RC = 4, etc. <br>
<br>
Since there may be more that one STDCAL, the &amp;SYSNDX parameter (and by extension, the shorter &amp;NDX parameter) should be used to generate the label of the first entry in the branch table as: <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BALR&nbsp; R14,R15 <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BTAB&amp;NDX(R15) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BTAB&amp;NDX&nbsp; B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LABEL1, 1st subparameter from &amp;BTAB <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; B&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; LABEL2, 2nd subparameter from &amp;BTAB <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; etc., up to a maximum of 4 labels.&nbsp; The last entry in the branch table should be followed by the following which will abend the program if a RC that is too high by 4 is returned. <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; S0C1&amp;NDX&nbsp;&nbsp; DC&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; H'0' <br>
<br>
If the &amp;BTAB parameter is absent, no branch table code should be generated. <br>
<h4><font size=4>Additional Requirements</font></b></h4>1. The program must end normally unless directed otherwise by your instructor.  <br>
<br>
2. The input data will be found in the following file. <br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <a href="../data/data9.txt">//FT05F001 DDDSN=T90MES1.C360(DATA11),DISP=SHR</a> 
			   
<hr size=4 noshade>

This page was last modified on Monday, December 03, 2001, at 03:29:21 PM CST

</body>
</html>